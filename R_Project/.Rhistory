violin_combined
violin_clean
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 3, y=1.4, label = "p50-quantile", color = "blue")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2, y=1.4, label = "p50-quantile", color = "blue")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.5, y=1.4, label = "p50-quantile", color = "blue")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
stat_summary(fun.y=median, geom="point", size=2, color="red")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
stat_summary(fun.y=median, geom="point", size=2, color="orange")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
stat_summary(fun.y=median, geom="point", size=2, color="orange") + #add median
geom_boxplot(width=0.1)
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
stat_summary(fun.y=median, geom="point", size=2, color="orange") + #add median
geom_boxplot(width=0.05)
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
stat_summary(fun.y=median, geom="point", size=2, color="orange") + #add median
geom_boxplot(width=0.05)
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
geom_boxplot(width=0.05)
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
geom_boxplot(width=0.05, color = "orange")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
geom_boxplot(width=0.03, color = "black")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
data_summary <- function(x) {
m <- mean(x)
ymin <- m-sd(x)
ymax <- m+sd(x)
return(c(y=m,ymin=ymin,ymax=ymax))
}
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
data_summary <- function(x) {
m <- mean(x)
ymin <- m-sd(x)
ymax <- m+sd(x)
return(c(y=m,ymin=ymin,ymax=ymax))
}
violin_combined + stat_summary(fun.data=data_summary)
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
#stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
data_summary <- function(x) {
m <- mean(x)
ymin <- m-sd(x)
ymax <- m+sd(x)
return(c(y=m,ymin=ymin,ymax=ymax))
}
violin_combined + stat_summary(fun.data=data_summary)
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
#stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
data_summary <- function(x) {
m <- mean(x)
ymin <- m-sd(x)
ymax <- m+sd(x)
return(c(y=m,ymin=ymin,ymax=ymax))
}
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue")  #add p50-quantile
data_summary <- function(x) {
m <- mean(x)
ymin <- m-sd(x)
ymax <- m+sd(x)
return(c(y=m,ymin=ymin,ymax=ymax))
}
violin_combined + stat_summary(fun.data=data_summary)
violin_combined
stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
stat_summary(fun.data="mean_sdl", mult=1,
geom="crossbar", width=0.2 )+
stat_summary(fun.data=mean_sdl, mult=1,
geom="pointrange", color="red")
stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
stat_summary(fun.data=mean_sdl, mult=1,
geom="pointrange", color="red")
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue")  #add p50-quantile
stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
stat_summary(fun.data=mean_sdl, mult=1,
geom="pointrange", color="red")
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
stat_summary(fun.data=mean_sdl, mult=1,
geom="pointrange", color="red")
violin_combined
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
#stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
stat_summary(fun.data=mean_sdl, mult=1,
geom="pointrange", color="red")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "orange")
#stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
#stat_summary(fun.data=mean_sdl, mult=1,
geom="pointrange", color="red")
violin_combined
violin_combined
violin_clean = ggplot(tcga_exp_prc_clean_var_df, aes(tcga_exp_prc_clean_var,y=1))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_vline(xintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 10, y=1.4, label = "p50-quantile", color = "blue")
violin = ggplot(tcga_prc_var_df, aes(tcga_prc_var,y=1))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_vline(xintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 10, y=1.4, label = "p50-quantile", color = "blue")
#create violin plot of data w/o low variance genes
tcga_exp_prc_clean = tcga_exp_protein_coding[-which(tcga_prc_var<= tcga_prc_var_p50),]
#create violin plot of data w/o low variance genes
tcga_exp_prc_clean = tcga_exp_protein_coding[-which(tcga_prc_var<= tcga_prc_var_p50),]
tcga_exp_prc_clean_var = apply(tcga_exp_prc_clean, 1, var)
tcga_exp_prc_clean_var_df = data.frame(tcga_exp_prc_clean_var)
violin_clean = ggplot(tcga_exp_prc_clean_var_df, aes(tcga_exp_prc_clean_var,y=1))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_vline(xintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 10, y=1.4, label = "p50-quantile", color = "blue")
violin_clean
#plot data before and after cleaning (only var<q50) next to each other
library(reshape2)
melting = cbind(tcga_prc_var_df, tcga_exp_prc_clean_var_df)
melting2 =melt(melting)
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "orange")
violin_combined
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "orange")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "orange") +
labs(title= "Variance Distribution")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "orange") +
ggtitle("Variance Distribution")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") +  ggtitle("Variance Distribution")
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "orange") +
#stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
#stat_summary(fun.data=mean_sdl, mult=1, geom="pointrange", color="red")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") +  ggtitle("Variance Distribution") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "orange") +
#stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
#stat_summary(fun.data=mean_sdl, mult=1, geom="pointrange", color="red")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("")  ggtitle("Variance Distribution") +
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") + ggtitle("Variance Distribution") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "orange") +
#stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
#stat_summary(fun.data=mean_sdl, mult=1, geom="pointrange", color="red")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "orange") +
ggtitle("Variance Distribution")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "orange") +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5))
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "black") +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5))
violin_combined
stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
#stat_summary(fun.data=mean_sdl, mult=1, geom="pointrange", color="red")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "black") +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange") + #add median
#stat_summary(fun.data=mean_sdl, mult=1, geom="pointrange", color="red")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "black") +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.001, color = "black") +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
+
+
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "black") +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
= "
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.02, color = "black") +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black", size = "1") +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black", size = 1) +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") +
geom_point(position = position_jitter(width = 0.1))+
geom_boxplot(width = 0.25, position= position_nudge(x=-.5))
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") +
geom_point(position = position_jitter(width = 0.1))+
geom_boxplot(width = 0.25, position= position_nudge(x=-.5)) +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") +
update_geom_defaults("point",list(size=5)) +
ggplot(df,aes(x,y))+geom_point()+
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") + geom_point()
update_geom_defaults("point",list(size=5))
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") + geom_point()
update_geom_defaults("point",list(size=5))
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") + geom_point() +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
update_geom_defaults("point",list(size=5))
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") + geom_point() +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
update_geom_defaults("point",list(size=0.1))
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") + geom_point() +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
update_geom_defaults("point",list(size=0.03))
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") + geom_point() +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
update_geom_defaults("point",list(size=0.00003))
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") + geom_point() +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
#create violin plot of uncleaned data
tcga_prc_var_df = data.frame(tcga_prc_var)
#class(tcga_prc_var_df)
tcga_prc_var_p50 = quantile(tcga_prc_var, 0.5) # use as threshold --> 19349 genes
violin = ggplot(tcga_prc_var_df, aes(tcga_prc_var,y=1))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_vline(xintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 10, y=1.4, label = "p50-quantile", color = "blue")
#create violin plot of data w/o low variance genes
tcga_exp_prc_clean = tcga_exp_protein_coding[-which(tcga_prc_var<= tcga_prc_var_p50),]
tcga_exp_prc_clean_var = apply(tcga_exp_prc_clean, 1, var)
tcga_exp_prc_clean_var_df = data.frame(tcga_exp_prc_clean_var)
violin_clean = ggplot(tcga_exp_prc_clean_var_df, aes(tcga_exp_prc_clean_var,y=1))+
geom_violin() + ylab ("") + xlab ("variance") +
geom_vline(xintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 10, y=1.4, label = "p50-quantile", color = "blue")
violin_clean
#plot data before and after cleaning (only var<q50) next to each other
library(reshape2)
melting = cbind(tcga_prc_var_df, tcga_exp_prc_clean_var_df)
melting2 =melt(melting)
update_geom_defaults("point",list(size=0.00003))
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") + geom_point() +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
#stat_summary(fun.data=mean_sdl, mult=1, geom="pointrange", color="red")
violin_combined
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") + geom_point() +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(face = "bold", hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange
violin_combined = ggplot(melting2, aes(x = variable,y=value))+
geom_violin() + ylab ("variance") + xlab ("") +
geom_hline(yintercept = tcga_prc_var_p50, color = "blue") +
annotate("text", x = 2.4, y=4.4, label = "p50-quantile", color = "blue") + #add p50-quantile
geom_boxplot(width=0.05, color = "black") + geom_point() +
ggtitle("Variance Distribution") +
theme(plot.title = element_text(hjust = 0.5)) +
stat_summary(fun=median, geom="point", size=2, color="orange")  #add median
violin_combined
#create violin plot of data w/o low variance genes
tcga_exp_prc_clean = tcga_exp_protein_coding[-which(tcga_prc_var<= tcga_prc_var_p50),]
violin_combined
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
#remove last 3 characters, run ONLY once!
#tcga_exp_protein_coding_new = c(substr(colnames(tcga_exp_protein_coding),1, nchar(colnames(tcga_exp_protein_coding))-3))
#colnames(tcga_exp_protein_coding) = tcga_exp_protein_coding_new
#dim(tcga_exp_protein_coding)
#summary(tcga_exp_protein_coding)
tcga_prc_var = apply(tcga_exp_protein_coding, 1, var)
