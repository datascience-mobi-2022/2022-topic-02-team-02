---
title: "Biomart"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#data upload
tcga_exp = readRDS("../data/tcga_tumor_log2TPM.RDS")
tcga_tumor_norm = readRDS("../data/tcga_tumor_normal_datascience_proj_2022.RDS")
library(biomaRt)
```


```{r}
gene_identifier = strsplit(rownames(tcga_exp), split = "|", fixed = TRUE)

genes_ens<- sapply(gene_identifier, FUN = function(gene_identifier){
  ens = gene_identifier[1]
  return(ens)
})

genes_symbol<- sapply(gene_identifier, FUN = function(gene_identifier){
  ens = gene_identifier[2]
  return(ens)
})

genes_ens_vn <- strsplit(genes_ens, split = ".", fixed = TRUE)
genes_ensembl <- sapply(genes_ens_vn, FUN = function(genes_ens_vn){
  ens = genes_ens_vn[1]
  return(ens)
})

mart = useEnsembl(dataset = "hsapiens_gene_ensembl", biomart='ensembl')

list_biotype = getBM(attributes = c("ensembl_gene_id", "gene_biotype"), filters = "ensembl_gene_id", 
                                    values = genes_ensembl, mart = mart, useCache = FALSE)

View(list_biotype)
```


```{r}
#extract expression data of KIRK cancer type, divided into tumor normal and annotation data, one data frame each
tcga_KIRC_tumor = data.matrix(tcga_tumor_norm[["KIRC"]][["tumor"]])
tcga_KIRC_norm = data.matrix(tcga_tumor_norm[["KIRC"]][["normal"]])
tcga_KIRC_annot = data.matrix(tcga_tumor_norm[["KIRC"]][["clinical"]])

```


```{r}
tcga_exp = readRDS("../data/tcga_tumor_log2TPM.RDS")
tcga_tumor_norm = readRDS("../data/tcga_tumor_normal_datascience_proj_2022.RDS")
library(biomaRt)
```


```{r}
gene_identifier_tumor = strsplit(rownames(tcga_KIRC_tumor), split = "|", fixed = TRUE)

genes_ens_tumor<- sapply(gene_identifier_tumor, FUN = function(gene_identifier_tumor){
  ens = gene_identifier_tumor[1]
  return(ens)
})

genes_symbol_tumor<- sapply(gene_identifier_tumor, FUN = function(gene_identifier_tumor){
  ens = gene_identifier_tumor[2]
  return(ens)
})

genes_ens_vn_tumor <- strsplit(genes_ens_tumor, split = ".", fixed = TRUE)
genes_ensembl_tumor <- sapply(genes_ens_vn_tumor, FUN = function(genes_ens_vn_tumor){
  ens = genes_ens_vn_tumor[1]
  return(ens)
})

mart = useEnsembl(dataset = "hsapiens_gene_ensembl", biomart='ensembl')

list_biotype = getBM(attributes = c("ensembl_gene_id", "gene_biotype"), filters = "ensembl_gene_id", 
                                    values = genes_ensembl_tumor, mart = mart, useCache = FALSE)

View(list_biotype_tumor)
dim(list_biotype_tumor)
