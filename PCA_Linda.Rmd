---
title: "PCA_pan_cancer"
author: "Linda Blaier"
date: '2022-05-29'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# work with tcga_exp_prc_clean -> w/o low variable under p50
# using prcomp() like in the exercise sheet
dim (tcga_exp_prc_clean)
tcga_exp_pca = prcomp (t(tcga_exp_prc_clean), center = F, scale. = F)
pca_var = tcga_exp_pca$sdev^2
proportion_pca_var = pca_var/sum(pca_var)
names_prop_pca_var = 1:length(proportion_pca_var)
barplot(proportion_pca_var[1:20])
tcga_exp_pca$sdev
```

```{r}
#data load = run Biotypes.Rmd to get tcga_exp_protein_coding

tcga_prc_var = apply(tcga_exp_protein_coding, 1, var)
tcga_prc_var_p50 = quantile(tcga_prc_var, 0.5)
tcga_exp_prc_clean = tcga_exp_protein_coding[-which(tcga_prc_var<= tcga_prc_var_p50),]
```

```{r}
nrow(tcga_exp_prc_clean)
svd(cor(tcga_exp_prc_clean), 2, 0)
```


```{r}
library(FactoMineR)
pca_exp_prc = PCA(tcga_exp_prc_clean)
```

